{"version":3,"sources":["index.js"],"names":["BarleyBreak","context","cellSize","arr","clicks","getRandom","Math","floor","random","getNullCell","i","j","draw","x","y","clearRect","font","textAlign","textBaseline","fillText","cellView","move","nullX","nullY","victory","e","res","mix","stepCount","hMove","upLeft","getClicks","window","onload","canvas","document","getElementById","getContext","width","height","game","event","fillRect","alert","onclick","pageX","offsetLeft","pageY","offsetTop","audio","sound","Audio","src","autoplay","ontouchend","touches","parcelRequire"],"mappings":"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","file":"src.116b915f.map","sourceRoot":"..\\src","sourcesContent":["window.onload = function () {\r\n    const canvas = document.getElementById(\"canvas\");\r\n    const context = canvas.getContext(\"2d\");\r\n    canvas.width = 320;\r\n    canvas.height = 320;\r\n    const cellSize = canvas.width / 4;\r\n    // const count = document.getElementById('count');\r\n\r\n    const game = new BarleyBreak(context, cellSize);\r\n    game.mix(300);\r\n    context.fillRect(0, 0, canvas.width, canvas.height); //отрисовка пустой клетки\r\n    game.draw();\r\n\r\n    canvas.onclick = function (e) {\r\n        let x = (e.pageX - canvas.offsetLeft) / cellSize | 0; // клик события\r\n        let y = (e.pageY - canvas.offsetTop) / cellSize | 0;\r\n        event(x, y);\r\n        audio();\r\n    };\r\n    canvas.ontouchend = function (e) {\r\n        let x = (e.touches[0].pageX - canvas.offsetLeft) / cellSize | 0; //тач события\r\n        let y = (e.touches[0].pageY - canvas.offsetTop) / cellSize | 0;\r\n        event(x, y);\r\n        \r\n    };\r\n\r\n    function event(x, y) { // собираем\r\n        game.move(x, y);\r\n        // game.audio();\r\n        context.fillRect(0, 0, canvas.width, canvas.height); //отрисовка пустой клетки\r\n        game.draw(); //отрисовка заполненых клеток и текста\r\n        if (game.victory()) { //проверка на правильность сборки\r\n            alert(\"Congratulations! Finished with \" + game.getClicks() + \" clicks!\");\r\n            game.mix(300);\r\n            context.fillRect(0, 0, canvas.width, canvas.height); //отрисовка пустой клетки\r\n            game.draw(context, cellSize);\r\n        }\r\n    }\r\n    const sound = parcelRequire(\"./audio/click.mp3\");\r\n    function audio(sound) {\r\n        const audio = new Audio();\r\n        audio.src = sound;\r\n        audio.autoplay = true;\r\n    };\r\n};\r\n\r\nfunction BarleyBreak(context, cellSize) {\r\n    const arr = [\r\n        [1, 2, 3, 4],\r\n        [5, 6, 7, 8],\r\n        [9, 10, 11, 12],\r\n        [13, 14, 15, 0]\r\n    ];\r\n    let clicks = 0;\r\n\r\n    function cellView(x, y) {\r\n        context.clearRect(x + 1, y + 1, cellSize - 2, cellSize - 2); // очистка ячейки\r\n    }\r\n\r\n    function numView() {\r\n        context.font = \"normal \" + (cellSize / 3) + \"px Verdana, Geneva, sans-serif\"; // стилизация чисел\r\n        context.textAlign = \"center\";\r\n        context.textBaseline = \"middle\";\r\n        // context.fillStyle = \"#000000\";\r\n    }\r\n\r\n    this.getNullCell = function () { // определение пустой ячейки\r\n        for (let i = 0; i < 4; i++) {\r\n            for (let j = 0; j < 4; j++) {\r\n                if (arr[j][i] === 0) {\r\n                    return {'x': i, 'y': j};\r\n                }\r\n            }\r\n        }\r\n    };\r\n    \r\n    this.draw = function () { // основная отрисовка\r\n        for (let i = 0; i < 4; i++) {\r\n            for (let j = 0; j < 4; j++) {\r\n                if (arr[i][j] > 0) {\r\n                    cellView(j * cellSize, i * cellSize);\r\n                    numView();\r\n                    context.fillText(arr[i][j], j * cellSize + cellSize / 2, i * cellSize + cellSize / 2);\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    this.move = function (x, y) { // движение\r\n        let nullX = this.getNullCell().x;\r\n        let nullY = this.getNullCell().y;\r\n        if (((x - 1 == nullX || x + 1 == nullX) && y == nullY) || ((y - 1 == nullY || y + 1 == nullY) && x == nullX)) {\r\n            arr[nullY][nullX] = arr[y][x];\r\n            arr[y][x] = 0;\r\n            clicks++;\r\n        }\r\n    };\r\n\r\n    this.victory = () => { // в случае победы\r\n        const e = [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12], [13, 14, 15, 0]];\r\n        let res = true;\r\n        for (let i = 0; i < 4; i++) {\r\n            for (let j = 0; j < 4; j++) {\r\n                if (e[i][j] != arr[i][j]) {\r\n                    res = false;\r\n                }\r\n            }\r\n        }\r\n        return res;\r\n    };\r\n\r\n    function getRandom() {\r\n        if (Math.floor(Math.random() * 2) === 0) {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    this.mix = function (stepCount) { //перемешивание\r\n        let x, y;\r\n        for (let i = 0; i < stepCount; i++) {\r\n            const nullX = this.getNullCell().x;\r\n            const nullY = this.getNullCell().y;\r\n            const hMove = getRandom();\r\n            const upLeft = getRandom();\r\n            if (!hMove && !upLeft) {\r\n                y = nullY;\r\n                x = nullX - 1;\r\n            }\r\n            if (hMove && !upLeft) {\r\n                x = nullX;\r\n                y = nullY + 1;\r\n            }\r\n            if (!hMove && upLeft) {\r\n                y = nullY;\r\n                x = nullX + 1;\r\n            }\r\n            if (hMove && upLeft) {\r\n                x = nullX;\r\n                y = nullY - 1;\r\n            }\r\n            if (0 <= x && x <= 3 && 0 <= y && y <= 3) {\r\n                this.move(x, y);\r\n            }\r\n        }\r\n        clicks = 0;\r\n    };\r\n\r\n    this.getClicks = () => {\r\n        return clicks;\r\n    };\r\n}\r\n\r\n\r\n\r\n\r\n"]}