{"version":3,"sources":["index.js"],"names":["window","onload","canvas","document","getElementById","context","getContext","width","height","cellSize","game","BarleyBreak","mix","fillRect","draw","onclick","e","x","pageX","offsetLeft","y","pageY","offsetTop","event","ontouchend","touches","move","victory","alert","getClicks","arr","clicks","cellView","clearRect","numView","font","textAlign","textBaseline","getNullCell","i","j","fillText","audio","sound","require","Audio","src","autoplay","nullX","nullY","res","getRandom","Math","floor","random","stepCount","hMove","upLeft"],"mappings":"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","file":"src.e31bb0bc.map","sourceRoot":"..\\src","sourcesContent":["window.onload = function () {\r\n    const canvas = document.getElementById(\"canvas\");\r\n    const context = canvas.getContext(\"2d\");\r\n    canvas.width = 320;\r\n    canvas.height = 320;\r\n    const cellSize = canvas.width / 4;\r\n    // const count = document.getElementById('count');\r\n\r\n    const game = new BarleyBreak(context, cellSize);\r\n    game.mix(300);\r\n    context.fillRect(0, 0, canvas.width, canvas.height); //отрисовка пустой клетки\r\n    game.draw();\r\n\r\n    canvas.onclick = function (e) {\r\n        let x = (e.pageX - canvas.offsetLeft) / cellSize | 0; // клик события\r\n        let y = (e.pageY - canvas.offsetTop) / cellSize | 0;\r\n        event(x, y);\r\n        // audio();\r\n    };\r\n    canvas.ontouchend = function (e) {\r\n        let x = (e.touches[0].pageX - canvas.offsetLeft) / cellSize | 0; //тач события\r\n        let y = (e.touches[0].pageY - canvas.offsetTop) / cellSize | 0;\r\n        event(x, y);\r\n        \r\n    };\r\n\r\n    function event(x, y) { // собираем\r\n        game.move(x, y);\r\n        // game.audio();\r\n        context.fillRect(0, 0, canvas.width, canvas.height); //отрисовка пустой клетки\r\n        game.draw(); //отрисовка заполненых клеток и текста\r\n        if (game.victory()) { //проверка на правильность сборки\r\n            alert(\"Congratulations! Finished with \" + game.getClicks() + \" clicks!\");\r\n            game.mix(300);\r\n            context.fillRect(0, 0, canvas.width, canvas.height); //отрисовка пустой клетки\r\n            game.draw(context, cellSize);\r\n        }\r\n    }\r\n    \r\n    \r\n};\r\n\r\nfunction BarleyBreak(context, cellSize) {\r\n    const arr = [\r\n        [1, 2, 3, 4],\r\n        [5, 6, 7, 8],\r\n        [9, 10, 11, 12],\r\n        [13, 14, 15, 0]\r\n    ];\r\n    let clicks = 0;\r\n\r\n    function cellView(x, y) {\r\n        context.clearRect(x + 1, y + 1, cellSize - 2, cellSize - 2); // очистка ячейки\r\n    }\r\n\r\n    function numView() {\r\n        context.font = \"normal \" + (cellSize / 3) + \"px Verdana, Geneva, sans-serif\"; // стилизация чисел\r\n        context.textAlign = \"center\";\r\n        context.textBaseline = \"middle\";\r\n        // context.fillStyle = \"#000000\";\r\n    }\r\n\r\n    this.getNullCell = function () { // определение пустой ячейки\r\n        for (let i = 0; i < 4; i++) {\r\n            for (let j = 0; j < 4; j++) {\r\n                if (arr[j][i] === 0) {\r\n                    return {'x': i, 'y': j};\r\n                }\r\n            }\r\n        }\r\n    };\r\n    \r\n    this.draw = function () { // основная отрисовка\r\n        for (let i = 0; i < 4; i++) {\r\n            for (let j = 0; j < 4; j++) {\r\n                if (arr[i][j] > 0) {\r\n                    cellView(j * cellSize, i * cellSize);\r\n                    numView();\r\n                    context.fillText(arr[i][j], j * cellSize + cellSize / 2, i * cellSize + cellSize / 2);\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    this.audio = function audio() {\r\n        const sound = require('../assets/audio/click.mp3');\r\n        const audio = new Audio();\r\n        audio.src = sound;\r\n        this.audio.autoplay = true;\r\n    };\r\n\r\n    this.move = function (x, y) { // движение\r\n        let nullX = this.getNullCell().x;\r\n        let nullY = this.getNullCell().y;\r\n        if (((x - 1 == nullX || x + 1 == nullX) && y == nullY) || ((y - 1 == nullY || y + 1 == nullY) && x == nullX)) {\r\n            arr[nullY][nullX] = arr[y][x];\r\n            arr[y][x] = 0;\r\n            clicks++;\r\n            this.audio();\r\n        }\r\n    };\r\n\r\n    this.victory = () => { // в случае победы\r\n        const e = [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12], [13, 14, 15, 0]];\r\n        let res = true;\r\n        for (let i = 0; i < 4; i++) {\r\n            for (let j = 0; j < 4; j++) {\r\n                if (e[i][j] != arr[i][j]) {\r\n                    res = false;\r\n                }\r\n            }\r\n        }\r\n        return res;\r\n    };\r\n\r\n    function getRandom() {\r\n        if (Math.floor(Math.random() * 2) === 0) {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    this.mix = function (stepCount) { //перемешивание\r\n        let x, y;\r\n        for (let i = 0; i < stepCount; i++) {\r\n            const nullX = this.getNullCell().x;\r\n            const nullY = this.getNullCell().y;\r\n            const hMove = getRandom();\r\n            const upLeft = getRandom();\r\n            if (!hMove && !upLeft) {\r\n                y = nullY;\r\n                x = nullX - 1;\r\n            }\r\n            if (hMove && !upLeft) {\r\n                x = nullX;\r\n                y = nullY + 1;\r\n            }\r\n            if (!hMove && upLeft) {\r\n                y = nullY;\r\n                x = nullX + 1;\r\n            }\r\n            if (hMove && upLeft) {\r\n                x = nullX;\r\n                y = nullY - 1;\r\n            }\r\n            if (0 <= x && x <= 3 && 0 <= y && y <= 3) {\r\n                this.move(x, y);\r\n            }\r\n        }\r\n        clicks = 0;\r\n    };\r\n\r\n    this.getClicks = () => {\r\n        return clicks;\r\n    };\r\n}\r\n\r\n\r\n\r\n\r\n"]}